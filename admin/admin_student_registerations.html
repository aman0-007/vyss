<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Vivek Yuv Seva Shakti - Admin Dashboard</title>
    <link rel="icon" type="image/jpeg" href="../assets/icon.jpeg">
    <link rel="shortcut icon" type="image/jpeg" href="../assets/icon.jpeg">
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: "#FF6B6B",
                            hover: "#FF4D4D"
                        },
                        secondary: "#4ECDC4",
                        accent: "#FFE66D",
                        background: {
                            light: "#F7FFF7",
                            dark: "#1A202C"
                        },
                        text: {
                            light: "#1A202C",
                            dark: "#E2E8F0"
                        },
                        "secondary-light": "#FFFFFF",
                        "secondary-dark": "#2D3748",
                    },
                    fontFamily: {
                        display: ["Poppins", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "0.5rem",
                    },
                },
            },
        };
    </script>
    <style>
        /* On-load animations */
        .fade-in-up { animation: fadeInUp 1s ease-out; }
        .fade-in-down { animation: fadeInDown 1s ease-out; }
        .fade-in-left { animation: fadeInLeft 1s ease-out; }
        .fade-in-right { animation: fadeInRight 1s ease-out; }
        .scale-in { animation: scaleIn 0.8s ease-out; }

        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInLeft { from { opacity: 0; transform: translateX(-30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes fadeInRight { from { opacity: 0; transform: translateX(30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes scaleIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        /* Smooth transitions for interactive elements */
        .smooth-transition { transition: all 0.3s ease; }
    </style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark">
    <div class="flex h-screen bg-background-light dark:bg-background-dark">
        <aside class="w-64 flex-shrink-0 bg-secondary-light dark:bg-secondary-dark shadow-lg fade-in-left">
            <div class="flex items-center justify-center h-20 border-b border-gray-200 dark:border-gray-700 border-r border-gray-300 dark:border-gray-600">
                <img alt="Vivek Yuv Seva Shakti Logo" class="h-14 w-auto" src="../assets/icon.jpeg" />
            </div>
            <nav class="mt-6">
                <a class="flex items-center px-6 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" href="admin_dashboard.html">
                    <span class="material-symbols-outlined mr-4">dashboard</span>
                    <span>Dashboard</span>
                </a>
                <a class="flex items-center px-6 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" href="admin_manage_events.html">
                    <span class="material-symbols-outlined mr-4">event</span>
                    <span>Manage Events</span>
                </a>
                <a class="flex items-center px-6 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" href="admin_event_photo-gallery.html">
                    <span class="material-symbols-outlined mr-4">photo_library</span>
                    <span>Photo Gallery</span>
                </a>
                <a class="flex items-center px-6 py-3 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700" href="admin_student_attendance.html">
                    <span class="material-symbols-outlined mr-4">co_present</span>
                    <span>Attendance</span>
                </a>
                <a class="flex items-center px-6 py-3 text-primary-DEFAULT bg-primary-DEFAULT/10 dark:bg-primary-DEFAULT/20 border-l-4 border-primary-DEFAULT" href="admin_student_registerations.html">
                    <span class="material-symbols-outlined mr-4">group</span>
                    <span>Student Registrations</span>
                </a>
            </nav>
            <div class="absolute bottom-0 w-64 p-6">
                <a class="flex items-center text-gray-600 dark:text-gray-300 hover:text-primary-DEFAULT" href="#">
                    <span class="material-symbols-outlined mr-4">logout</span>
                    <span>Logout</span>
                </a>
            </div>
        </aside>
        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="flex items-center justify-between h-20 px-6 border-b border-gray-200 dark:border-gray-700 bg-secondary-light dark:bg-secondary-dark fade-in-down">
                <h1 class="text-2xl font-semibold text-text-light dark:text-text-dark" data-aos="fade-up">Student Registrations</h1>
                <div class="flex items-center space-x-4">
                    <span class="text-gray-600 dark:text-gray-300">Welcome, Admin</span>
                    <img alt="Admin Avatar" class="h-10 w-10 rounded-full object-cover" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCg14aZ9sSsjlMrygaUfrMVbU1IX9BfGbT6eI2lzI91IGu6FDBWr6wZLdjV2GEdb3bR9NzTD2m7P05w-ZZ9jHG5YfcTiEYHOOY7Ei3DS6j1VdH-WbNDdy4Gd6tkYZXsms8M45NKh4IchsXMWsTTNNa-gYP67wp21_E7fwCkDpRU0djWDEZQW2Y_fIIt0_bMlqj5iSiw47NaOHfO5Oj2QLXWJqSkPcFQlJXUGYlLKRrEqrs0ETkLNfJY0Venzl5fX4riAdvJK_sqw1sB" />
                </div>
            </header>
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-background-light dark:bg-background-dark p-6 fade-in-right">
                <div class="bg-secondary-light dark:bg-secondary-dark p-6 rounded-lg shadow-md mb-6" data-aos="fade-up">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" for="search-student">Search Student</label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="material-symbols-outlined text-gray-400">search</span>
                                </div>
                                <input class="w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark pl-10 focus:border-primary-DEFAULT focus:ring-primary-DEFAULT" id="search-student" name="search-student" placeholder="Search by name, email or ID" type="text" />
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" for="event-filter">Filter by Event</label>
                            <select class="w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark focus:border-primary-DEFAULT focus:ring-primary-DEFAULT" id="event-filter" name="event-filter">
                                <option>All Events</option>
                                <option>Tree Plantation Drive</option>
                                <option>Youth Leadership Workshop</option>
                                <option>Blood Donation Camp</option>
                                <option>Career Guidance Seminar</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" for="status-filter">Filter by Status</label>
                            <select class="w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark focus:border-primary-DEFAULT focus:ring-primary-DEFAULT" id="status-filter" name="status-filter">
                                <option>All Statuses</option>
                                <option>Approved</option>
                                <option>Pending</option>
                                <option>Rejected</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="bg-secondary-light dark:bg-secondary-dark rounded-lg shadow-md" data-aos="fade-up" data-aos-delay="100">
                    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center" data-aos="fade-up" data-aos-delay="200">
                        <div>
                            <h2 class="text-xl font-semibold text-text-light dark:text-white">All Registered Students</h2>
                            <p id="student-count-display" class="text-sm text-gray-500 dark:text-gray-400">
                                    Loading count...
                            </p>
                        </div>
                        <button id="RegisterStudentBtn" class="bg-primary-hover text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-primary-DEFAULT transition duration-300 flex items-center justify-center smooth-transition">
                            <span class="material-symbols-outlined mr-2 text-base">person_add</span>
                            Add New Student
                        </button>
                    </div>
                    <div class="overflow-x-auto" data-aos="fade-up" data-aos-delay="300">
                        <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                            <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                                <tr>
                                    <th class="px-6 py-3" scope="col">Student Name</th>
                                    <th class="px-6 py-3" scope="col">Registration ID</th>
                                    <th class="px-6 py-3" scope="col">Registered For</th>
                                    <th class="px-6 py-3 text-center" scope="col">Status</th>
                                    <th class="px-6 py-3 text-center" scope="col">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="student-table-body">
                                <tr>
                                    <td colspan="5" class="text-center p-8 text-gray-500">
                                        Loading student data...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex justify-end">
                        <nav aria-label="Page navigation">
                            <ul id="pagination-controls" class="inline-flex items-center -space-x-px">
                            </ul>
                        </nav>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <div id="studentModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div id="modalContent" class="bg-secondary-light dark:bg-secondary-dark rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto transform scale-95 opacity-0 transition-all duration-300">
            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                <h2 class="text-2xl font-bold text-text-light dark:text-white">Add New Student</h2>
                <button id="closeModal" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-200">
                    <span class="material-symbols-outlined text-3xl">close</span>
                </button>
            </div>

            <form id="studentForm" class="p-6 space-y-6">
                <div class="form-group">
                    <label for="studentName" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        Student Name <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="studentName" name="studentName" required class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark focus:ring-2 focus:ring-primary-DEFAULT focus:border-transparent transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500" placeholder="Enter student's full name">
                    <div class="error-message hidden text-red-500 text-sm mt-1"></div>
                </div>

                <div class="form-group">
                    <label for="registrationId" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        Registration ID <span class="text-red-500">*</span>
                    </label>
                    <input type="text" id="registrationId" name="registrationId" required class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark focus:ring-2 focus:ring-primary-DEFAULT focus:border-transparent transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500" placeholder="VYSS-2024-XXX">
                    <div class="error-message hidden text-red-500 text-sm mt-1"></div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label for="studentClass" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                            Class <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="studentClass" name="studentClass" required class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark focus:ring-2 focus:ring-primary-DEFAULT focus:border-transparent transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500" placeholder="e.g., 12th Grade, Bachelor's">
                        <div class="error-message hidden text-red-500 text-sm mt-1"></div>
                    </div>
                    <div class="form-group">
                        <label for="academicYear" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                            Academic Year <span class="text-red-500">*</span>
                        </label>
                        <select id="academicYear" name="academicYear" required class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark focus:ring-2 focus:ring-primary-DEFAULT focus:border-transparent transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500">
                            <option value="">Select Academic Year</option>
                            <option value="2024-2025">2024-2025</option>
                            <option value="2023-2024">2023-2024</option>
                            <option value="2022-2023">2022-2023</option>
                            <option value="2021-2022">2021-2022</option>
                        </select>
                        <div class="error-message hidden text-red-500 text-sm mt-1"></div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="form-group">
                        <label for="studentEmail" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                            Email Address <span class="text-red-500">*</span>
                        </label>
                        <input type="email" id="studentEmail" name="studentEmail" required class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark focus:ring-2 focus:ring-primary-DEFAULT focus:border-transparent transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500" placeholder="student@example.com">
                        <div class="error-message hidden text-red-500 text-sm mt-1"></div>
                    </div>
                    <div class="form-group">
                        <label for="studentPhone" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                            Phone Number <span class="text-red-500">*</span>
                        </label>
                        <input type="tel" id="studentPhone" name="studentPhone" required class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark focus:ring-2 focus:ring-primary-DEFAULT focus:border-transparent transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500" placeholder="+91 9876543210">
                        <div class="error-message hidden text-red-500 text-sm mt-1"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="registeredFor" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                        Registered For <span class="text-red-500">*</span>
                    </label>
                    <select id="registeredFor" name="registeredFor" required class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-text-light dark:text-text-dark focus:ring-2 focus:ring-primary-DEFAULT focus:border-transparent transition-all duration-200 hover:border-gray-400 dark:hover:border-gray-500">
                        <option value="">Select Activity/Event</option>
                        <option value="Tree Plantation Drive">Tree Plantation Drive</option>
                        <option value="Youth Leadership Workshop">Youth Leadership Workshop</option>
                        <option value="Blood Donation Camp">Blood Donation Camp</option>
                        <option value="Career Guidance Seminar">Career Guidance Seminar</option>
                        <option value="Community Cleanup">Community Cleanup</option>
                        <option value="Environmental Conservation">Environmental Conservation</option>
                        <option value="Skill Development Workshop">Skill Development Workshop</option>
                    </select>
                    <div class="error-message hidden text-red-500 text-sm mt-1"></div>
                </div>

                <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-gray-200 dark:border-gray-700">
                    <button type="button" id="cancelBtn" class="flex-1 px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200 transform hover:scale-[1.02]">
                        Cancel
                    </button>
                    <button type="submit" id="submitBtn" class="flex-1 px-6 py-3 bg-primary-DEFAULT text-white rounded-lg font-medium hover:bg-primary-hover focus:outline-none focus:ring-2 focus:ring-primary-DEFAULT focus:ring-offset-2 transition-all duration-200 transform hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
                        <span class="submit-text">Add Student</span>
                        <span class="loading-spinner hidden">
                            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white inline" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            Processing...
                        </span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="successToast" 
         class="fixed top-4 right-4 bg-green-500 text-white px-6 py-4 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 z-50" 
         style="transform: translateX(105%);">
        <div class="flex items-center">
            <span class="material-symbols-outlined mr-2">check_circle</span>
            <span>Student registered successfully!</span>
        </div>
    </div>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Initialize AOS (Animate On Scroll)
        AOS.init({
            duration: 800,
            easing: 'ease-out',
            once: true,
            offset: 100
        });

        // Student Registration Modal Functionality
        class StudentRegistrationModal {
            constructor() {
                this.modal = document.getElementById('studentModal');
                this.modalContent = document.getElementById('modalContent');
                this.form = document.getElementById('studentForm');
                this.openBtn = document.getElementById('RegisterStudentBtn');
                this.closeBtn = document.getElementById('closeModal');
                this.cancelBtn = document.getElementById('cancelBtn');
                this.submitBtn = document.getElementById('submitBtn');
                this.successToast = document.getElementById('successToast');
                
                this.init();
            }

            init() {
                // Event listeners
                this.openBtn.addEventListener('click', () => this.openModal());
                this.closeBtn.addEventListener('click', () => this.closeModal());
                this.cancelBtn.addEventListener('click', () => this.closeModal());
                this.modal.addEventListener('click', (e) => {
                    if (e.target === this.modal) this.closeModal();
                });

                // CORRECTED: Added the event listener for the form submission here.
                // It now correctly calls the handleSubmit method of the class.
                this.form.addEventListener('submit', (e) => this.handleSubmit(e));
                
                // Real-time validation
                this.setupValidation();
                
                // Keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && !this.modal.classList.contains('hidden')) {
                        this.closeModal();
                    }
                });
            }

            // MOVED: handleSubmit is now a proper class method, at the same level as init() and openModal().
            async handleSubmit(e) {
                e.preventDefault();

                let isFormValid = true;
                const inputs = this.form.querySelectorAll('input[required], select[required]');
                inputs.forEach(input => {
                    if (!this.validateField(input)) {
                        isFormValid = false;
                    }
                });

                if (!isFormValid) {
                    return;
                }

                this.setLoadingState(true);

                try {
                    // IMPROVED: Switched to getElementById for more reliable data gathering.
                    const studentData = {
                        name: document.getElementById('studentName').value,
                        registrationId: document.getElementById('registrationId').value,
                        studentClass: document.getElementById('studentClass').value,
                        academicYear: document.getElementById('academicYear').value,
                        email: document.getElementById('studentEmail').value,
                        phone: document.getElementById('studentPhone').value,
                        registeredFor: document.getElementById('registeredFor').value,
                    };

                    const success = await window.registerStudent(studentData);

                    if (success) {
                        this.showSuccessToast();
                        this.closeModal();
                        window.refreshStudentTable();
                    } else {
                        alert('Registration failed. Please try again.');
                    }
                } catch (error) {
                    console.error('Registration failed:', error);
                    alert('Registration failed. An unexpected error occurred.');
                } finally {
                    this.setLoadingState(false);
                }
            }
            
            openModal() {
                this.modal.classList.remove('hidden');
                this.modal.classList.add('flex');
                document.body.style.overflow = 'hidden';
                
                setTimeout(() => {
                    this.modalContent.classList.remove('scale-95', 'opacity-0');
                    this.modalContent.classList.add('scale-100', 'opacity-100');
                }, 10);
                
                setTimeout(() => {
                    document.getElementById('studentName').focus();
                }, 300);
            }

            closeModal() {
                this.modalContent.classList.remove('scale-100', 'opacity-100');
                this.modalContent.classList.add('scale-95', 'opacity-0');
                document.body.style.overflow = '';
                
                setTimeout(() => {
                    this.modal.classList.add('hidden');
                    this.modal.classList.remove('flex');
                    this.resetForm();
                }, 300);
            }

            setupValidation() {
                const inputs = this.form.querySelectorAll('input, select');
                inputs.forEach(input => {
                    input.addEventListener('blur', () => this.validateField(input));
                    input.addEventListener('input', () => this.clearError(input));
                });
            }

            validateField(field) {
                const value = field.value.trim();
                let isValid = true;
                let errorMessage = '';

                this.clearError(field);

                if (field.hasAttribute('required') && !value) {
                    errorMessage = 'This field is required.';
                    isValid = false;
                }

                if (isValid && value) {
                    switch (field.type) {
                        case 'email':
                            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value)) {
                                errorMessage = 'Please enter a valid email address.';
                                isValid = false;
                            }
                            break;
                        case 'tel':
                            if (!/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/.test(value)) {
                                errorMessage = 'Please enter a valid phone number.';
                                isValid = false;
                            }
                            break;
                    }
                    if (field.id === 'registrationId' && !/^VYSS-\d{4}-\d{3}$/.test(value)) {
                        errorMessage = 'ID must be in VYSS-YYYY-XXX format.';
                        isValid = false;
                    }
                }

                if (!isValid) {
                    this.showError(field, errorMessage);
                }
                return isValid;
            }

            showError(field, message) {
                const errorDiv = field.parentNode.querySelector('.error-message');
                if(errorDiv) {
                    field.classList.add('border-red-500', 'focus:ring-red-500');
                    field.classList.remove('border-gray-300', 'focus:ring-primary-DEFAULT');
                    errorDiv.textContent = message;
                    errorDiv.classList.remove('hidden');
                }
            }

            clearError(field) {
                const errorDiv = field.parentNode.querySelector('.error-message');
                    if(errorDiv) {
                    field.classList.remove('border-red-500', 'focus:ring-red-500');
                    field.classList.add('border-gray-300', 'focus:ring-primary-DEFAULT');
                    errorDiv.classList.add('hidden');
                }
            }

            setLoadingState(loading) {
                const submitText = this.submitBtn.querySelector('.submit-text');
                const loadingSpinner = this.submitBtn.querySelector('.loading-spinner');
                
                if (loading) {
                    this.submitBtn.disabled = true;
                    submitText.classList.add('hidden');
                    loadingSpinner.classList.remove('hidden');
                } else {
                    this.submitBtn.disabled = false;
                    submitText.classList.remove('hidden');
                    loadingSpinner.classList.add('hidden');
                }
            }

            showSuccessToast() {
                this.successToast.style.transform = 'translateX(0)';
                setTimeout(() => {
                    this.successToast.style.transform = 'translateX(105%)';
                }, 3000);
            }

            resetForm() {
                this.form.reset();
                const inputs = this.form.querySelectorAll('input, select');
                inputs.forEach(input => this.clearError(input));
            }
        }

        // Initialize modal when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new StudentRegistrationModal();
        });
    </script>
    <script type="module" src="../backend/admin_students_registration_main.js"></script>
</body>
</html>